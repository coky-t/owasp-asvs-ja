# V4: アクセス制御検証要件

## 管理目標

認可とはリソースの使用を許可された人にのみアクセスを許可するという概念です。検証されるアプリケーションが以下の上位レベルの要件を満たしていることを確認します。

* リソースにアクセスする人はそうするために有効な資格情報を保持しています。
* ユーザーは明確に定義された役割と権限のセットに関連付けられています。
* 役割とパーミッションのメタデータはリプレイや改竄から保護されています。

## セキュリティ検証要件

| # | 説明 | L1 | L2 | L3 | 導入バージョン |
| --- | --- | --- | --- | -- | -- |
| **4.1** | 最小特権の原則が存在することを検証します。ユーザーは特定の権限を持つ機能、データファイル、URL、コントローラ、サービス、およびその他のリソースにのみアクセスできるようにすべきです。これはなりすましや特権昇格に対する保護を意味します。 | ✓ | ✓ | ✓ | 1.0 |
| **4.4** | 機密データおよび API が、レコードの作成、読み取り、更新、削除を対象とする直接オブジェクト攻撃に対して保護されていることを検証します。 | ✓ | ✓ | ✓ | 4.0 |
| **4.5** | 明確に必要でない限りディレクトリ参照が無効化されていることを検証します。さらに、アプリケーションは Thumbs.db, .DS_Store, .git, .svn などのファイルやディレクトリメタデータの漏洩や開示を許すべきではありません。 | ✓ | ✓ | ✓ | 1.0 |
| **4.8** | アクセス制御がセキュアに失敗することを検証します。 | ✓ | ✓ | ✓ | 1.0 |
| **4.9** | プレゼンテーション層に含まれるものと同じアクセス制御規則がサーバー側で実施されていることを検証します。 | ✓ | ✓ | ✓ | 1.0 |
| **4.10** | アクセス制御で使用されるすべてのユーザー属性とデータ属性およびポリシー情報は、特に認可されていない限りエンドユーザーが操作できないことを検証します。 | ✓ | ✓ | ✓ | 1.0 |
| **4.11** | ハードコードされたアクセス制御チェックがアプリケーション全体で必要とされないように、保護されたデータおよびリソースへのアクセスを保護するためのアクセス制御メカニズムはできれば入念に検査された一つだけであることを検証します。 |  | ✓ | ✓ | 4.0 |
| **4.12** | すべてのアクセス制御判定がログに記録され、失敗したすべての判定がログに記録されることを検証します。 |  | ✓ | ✓ | 2.0 |
| **4.13** | 機密性の高い機能を保護するために、アプリケーションやフレームワークが強力な CSRF 対策メカニズムを実施していることを検証します。 | ✓ | ✓ | ✓ | 4.0 |
| **4.14** | データ流出、過剰なビジネスロジック要求、サービス拒否攻撃に対して検出および保護するために、アプリケーションに十分な自動化対策があることを検証します。 |  | ✓ | ✓ | 4.0 |
| **4.15** | アプリケーションには低価値システムに対する追加の認証 (ステップアップ認証や適応認証) があること、また、アプリケーションのリスクと過去の不正行為により不正対策制御を実施するために、高価値アプリケーションに対する役割の分離があることを検証します。 |  | ✓ | ✓ | 3.0 |
| **4.16** | アクセス制御ポリシーがサーバー側で実施されていることを検証します。 | ✓ | ✓ | ✓ | 4.0 |
| **4.17** | 個々のレコードへのアクセスを集中的かつ標準的な方法で管理できるように、データレベルのアクセス制御が実装されていることを検証します。 | ✓ | ✓ | ✓ | 4.0 |
| **4.18** | 管理インタフェースは不正使用を防ぐために適切な多要素認証を使用していることを検証します。 | ✓ | ✓ | ✓ | 4.0 |

## 参考情報

詳細については、以下も参照してください。

* [OWASP Testing Guide 4.0: Authorization](https://www.owasp.org/index.php/Testing_for_Authorization)
* [OWASP Cheat Sheet: Access Control](https://www.owasp.org/index.php/Access_Control_Cheat_Sheet)
* [OWASP CSRF Cheat Sheet](https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)_Prevention_Cheat_Sheet)
* [OWASP REST Cheat Sheet](https://www.owasp.org/index.php/REST_Security_Cheat_Sheet)
* [OWASP AppSensor](https://www.owasp.org/index.php/OWASP_AppSensor_Project) や [OWASP Automated Threats to Web Applications](https://www.owasp.org/index.php/OWASP_Automated_Threats_to_Web_Applications) のユーザーを含め、自動化対策はさまざまな方法で実現できます。

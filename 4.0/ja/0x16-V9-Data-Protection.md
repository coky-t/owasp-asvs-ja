# V9: データ保護検証要件

## 管理目標

堅実なデータ保護には機密性、完全性、可用性 (CIA) という三つの重要な要素があります。この標準規格では、堅牢化され十分な保護が施されているサーバーなど、信頼できるシステムでデータ保護が実施されていることを前提としています。

アプリケーションはすべてのユーザーデバイスが何らかの方法で危殆化されていると想定する必要があります。共有コンピュータ、スマホ、タブレットなどのセキュアでないデバイスにアプリケーションが機密情報を転送または保存する場合、アプリケーションはこれらのデバイスに保存されたデータが暗号化され、容易かつ不正に入手、改竄、開示されないようにする責任があります。

検証されるアプリケーションが以下の上位レベルのデータ保護要件を満たしていることを確認します。

* 機密性: データは転送時および保存時のいずれにおいても不正な閲覧や開示から保護されるべきです。
* 完全性: データは認可されていない攻撃者による偽造、改竄、削除から保護されるべきです。
* 可用性: データは認可されたユーザーに必要に応じて利用可能であるべきです。

## セキュリティ検証要件

| # | 説明 | L1 | L2 | L3 | 導入バージョン |
| --- | --- | --- | --- | -- | -- |
| **9.2** | アプリケーションにより作成および処理されるすべての機密データを特定し、機密データを処理する方法に関するポリシーが整っていることを確認します。 | ✓ | ✓ | ✓ | 4.0 |
| **9.3** | 機密データが HTTP/S メッセージボディまたはヘッダでサーバーに送信され、HTTP verb のクエリ文字列パラメータには機密データが含まれていないことを検証します。 | ✓ | ✓ | ✓ | 1.0 |
| **9.4** | 機密データが現在のブラウザでキャッシュされないように、アプリケーションは十分なキャッシュ防止ヘッダを設定していることを検証します。 | ✓ | ✓ | ✓ | 4.0 |
| **9.5** | ロードバランサやアプリケーションキャッシュなどのサーバーコンポーネントにキャッシュされないように、アプリケーションは機密データを保護していることを検証します。 | ✓ | ✓ | ✓ | 4.0 |
| **9.6** | サーバー上で保存されている機密データのすべてのキャッシュや一時コピーが、不正なアクセスから保護されているか、認可されたユーザーが機密データにアクセスした後に削除または無効化されることを検証します。 |  | ✓ | ✓ | 1.0 |
| **9.7** | ユーザーが自分のデータをオンデマンドで削除またはエクスポートする方法を持っていることを検証します。 | ✓ | ✓ | ✓ | 4.0 |
| **9.8** | アプリケーションが、隠しフィールド、Ajax 変数、Cookie 、ヘッダ値など、リクエスト内のパラメータ数を最小限に抑えていることを検証します。 |  | ✓ | ✓ | 2.0 |
| **9.9** | アプリケーションには異常な数のリクエストを検出および警告する機能があることを検証します。 |  | ✓ | ✓ | 4.0 |
| **9.10** | クライアント側ストレージ (HTML5 ローカルストレージ、セッションストレージ、IndexedDB、通常の Cookie、Flash Cookie など) に保存されているデータに機密データやPII (個人識別情報) が含まれていないことを検証します。 | ✓ | ✓ | ✓ | 3.0.1 |
| **9.11** | データが関連するデータ保護規制の下で収集されている場合やアクセスのログ記録が必要な場合には、機密データへのアクセスがログ記録されていることを検証します。 |  | ✓ | ✓ | 3.0 |
| **9.12** | メモリダンプ攻撃を軽減するために、メモリに保持された機密情報は不要になればすぐにゼロで上書きされることを検証します。 |  | ✓ | ✓ | 3.0.1 |
| **9.13** | 暗号化を必要とする機密情報や個人情報は、機密性と完全性の両方を提供する認証済みアルゴリズムを使用して暗号化されていることを検証します。 | ✓ | ✓ | ✓ | 3.0.1 |
| **9.14** | 提供された個人情報の収集および使用に関して明確な表現でユーザーに提供されていること、およびそれが何らかの方法で使用される前にユーザーが提供されたオプトインでそのデータの使用に同意をしていることを検証します。 | ✓ | ✓ | ✓ | 4.0 |
| **9.15** | クライアントやセッションが終了した後、ブラウザ DOM などのクライアントストレージから認証データがクリアされることを検証します。 |  | ✓ | ✓ | 3.0 |
| **9.16** | 重要なデータの定期的なバックアップが実行され、リストアテストが実行されていることを検証します。 |  | ✓ | ✓ | 4.0 |
| **9.17** | データの盗難や破損を防ぐために、バックアップがセキュアに保存されていることを検証します。 |  | ✓ | ✓ | 4.0 |

## 参考情報

詳細については、以下も参照してください。

* [Consider using Security Headers website to check security and anti-caching headers](https://securityheaders.io)
* [OWASP Secure Headers project](https://www.owasp.org/index.php/OWASP_Secure_Headers_Project)
* [User Privacy Protection Cheat Sheet](https://www.owasp.org/index.php/User_Privacy_Protection_Cheat_Sheet)

# V7: 暗号化検証要件

## 管理目標

検証されるアプリケーションが以下の上位レベルの要件を満たしていることを確認します。

* すべての暗号化モジュールはセキュアな方法で失敗し、エラーは正しく処理されること。
* ランダム性が要求される場合には適切な乱数生成器が使用されること。
* 鍵へのアクセスはセキュアな方法で管理されていること。

## セキュリティ検証要件

| # | 説明 | L1 | L2 | L3 | 導入バージョン |
| --- | --- | --- | --- | -- | -- |
| **7.2** | すべての暗号化モジュールがセキュアに失敗し、エラーはパディングオラクル攻撃を有効化しない方法で処理されていることを検証します。 | ✓ | ✓ | ✓ | 1.0 |
| **7.6** | すべての乱数、ランダムなファイル名、ランダムな GUID、ランダムな文字列は、これらの乱数値が攻撃者に推測できないことを意図している場合、暗号化モジュールの認める乱数生成器を使用して生成されていることを検証します。 |  | ✓ | ✓ | 1.0 |
| **7.7** | アプリケーションで使用される暗号化アルゴリズムは FIPS 140-2 または同等の標準規格で妥当性確認されたものであることを検証します。 | ✓ | ✓ | ✓ | 1.0 |
| **7.11** | 暗号化サービスの消費者は、Key Vault や API ベースの代替を使用するなどして、鍵マテリアルに直接アクセスできないことを検証します。 |  | ✓ | ✓ | 4.0 |
| **7.12** | 個人識別情報 (PII) およびその他の機密データは保存時に暗号化されて保管されていることを検証します。 |  | ✓ | ✓ | 4.0 |
| **7.13** | メモリに保持されている機密のパスワードや鍵マテリアルは、メモリダンプ攻撃を低減するために、不要になった時点でゼロで上書きされていることを検証します。 |  | ✓ | ✓ | 4.0 |
| **7.14** | すべての鍵とパスワードは置き換え可能であり、インストール時に生成または置換されていることを検証します。 |  | ✓ | ✓ | 3.0 |
| **7.15** | アプリケーションが高負荷の下にある場合でも乱数は適切なエントロピーで作成されていること、またはそのような状況ではアプリケーションが優美にデグレードしていることを検証します。 |  |  | ✓ | 3.0 |
| **7.16** | カスタムコードの暗号化ではなく、業界で実績のある暗号化モジュールが使用されていることを検証します。 | ✓ | ✓ | ✓ | 4.0 |

## 参考情報

詳細については、以下も参照してください。

* [OWASP Testing Guide 4.0: Testing for weak Cryptography](https://www.owasp.org/index.php/Testing_for_weak_Cryptography)
* [OWASP Cheat Sheet: Cryptographic Storage](https://www.owasp.org/index.php/Cryptographic_Storage_Cheat_Sheet)

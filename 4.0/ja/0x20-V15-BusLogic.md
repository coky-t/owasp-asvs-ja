# V15: ビジネスロジック検証要件

## 管理目標

検証されるアプリケーションが以下の上位レベルの要件を満たしていることを確認します。

* ビジネスロジックフローはシーケンシャルであり、順番に処理され、迂回できません。
* ビジネスロジックには継続的な小額の資金転送や一度に百万の友人の追加などの自動攻撃を検出および防御するための制限を含んでいます。
* 高価値のビジネスロジックフローでは悪用ケースや悪意のある人物を考慮し、なりすまし、改竄、否認、情報漏洩、権限昇格の攻撃に対する保護を有しています。

## セキュリティ検証要件

| # | 説明 | L1 | L2 | L3 | CWE | CWSS |
| :---: | :--- | :---: | :---:| :---: | :---: | :---: |
| **15.1** | アプリケーションは同じユーザーのビジネスロジックフローをシーケンシャルなステップ順序でのみ処理し、ステップをスキップしないことを検証します。 | ✓ | ✓ | ✓ | tbd | tbd |
| **15.2** | アプリケーションはすべてのステップで現実的な人的時間、すなわちトランザクションがあまりに速く送信されていない、で処理されたビジネスロジックフローのみを処理することを検証します。 |  | ✓ | ✓ | tbd | tbd |
| **15.3** | アプリケーションはユーザーごとに正しく適用される特定のビジネスアクションやトランザクションに対して適切な制限があることを検証します。 | ✓ | ✓ | ✓ | tbd | tbd |
| **15.4** | アプリケーションはビジネスロジックの観点から異常なイベントやアクティビティを監視していることを検証します。例えば、順序の異なるアクションや通常のユーザーが決して行わないアクションを実行しようと試みます。 |  | ✓ | ✓ | tbd | tbd |
| **15.5** | アプリケーションは自動化された攻撃や異常なアクティビティが検出されたときに設定可能なアラートを発していることを検証します。 |  | ✓ | ✓ | tbd | tbd |
| **15.6** | アプリケーションは自動化された攻撃や異常なアクティビティが検出されたときに自動化されたリアクションを行うことを検証します。 |  |  | ✓ | tbd | tbd |
| **15.7** | アプリケーションはデータ流出、過剰なビジネスロジックリクエスト、過度のファイルアップロード、サービス拒否攻撃に対して検出および防御するための十分な自動化防止コントロールがあることを検証します。 |  | ✓ | ✓ | tbd | tbd |

## 参考情報

詳細については、以下も参照してください。

* [OWASP Testing Guide 4.0: Business Logic Testing](https://www.owasp.org/index.php/Testing_for_business_logic)
* [OWASP Cheat Sheet](https://www.owasp.org/index.php/Business_Logic_Security_Cheat_Sheet)
* [OWASP AppSensor](https://www.owasp.org/index.php/OWASP_AppSensor_Project) や [OWASP Automated Threats to Web Applications](https://www.owasp.org/index.php/OWASP_Automated_Threats_to_Web_Applications) の使用を含め、自動化対策はさまざまな方法で実現できます。
* [OWASP AppSensor](https://www.owasp.org/index.php/OWASP_AppSensor_Project) は攻撃検出と対応にも役立ちます。

# V9: 通信検証要件

## 管理目標

検証されるアプリケーションが以下の上位レベルの要件を満たしていることを確認します。

* 送信されるデータの機密性に関係なく、TLS または強力な暗号化が常に使用されています。
* 最新の主要な構成アドバイスを使用して、優先アルゴリズムおよび暗号化方式を有効化および順序付けしています。
* 脆弱または近いうちに廃止予定のアルゴリズムおよび暗号化方式は最後の手段として順序付けされています。
* 非推奨または既知のセキュアではないアルゴリズムおよび暗号化方式は無効化されています。

セキュアな TLS 構成に関する業界の主要なアドバイスは、既存のアルゴリズムおよび暗号化方式の壊滅的な破壊が原因で頻繁に変更されます。常に最新バージョンの TLS 構成レビューツール (SSLyze や他の TLS スキャナなど) を使用して、優先順位およびアルゴリズム選択を設定します。構成を定期的にチェックし、セキュアな通信設定が常に存在し有効であることを確認します。

## V9.1 クライアント通信セキュリティ要件

すべてのクライアント通信は暗号化された通信パスを介してのみ行われるべきです。特に TLS 1.2 以降の使用が基本的にすべてですが、最新のブラウザや検索エンジンでは必須です。最新の主要なプラクティスが実施されていることを確認するために、オンラインツールを使用して構成を定期的にレビューすべきです。

| # | 説明 | L1 | L2 | L3 | CWE |
| :---: | :--- | :---: | :---:| :---: | :---: |
| **9.1.1** | TLS がすべてのクライアント接続に使用されており、セキュアではない通信や暗号化されていない通信にフォールバックしないことを検証します。 ([C8](https://owasp.org/www-project-proactive-controls/#div-numbering)) | ✓ | ✓ | ✓ | 319 |
| **9.1.2** | オンラインまたは最新の TLS テストツールを使用して、強力な暗号スイートのみが有効であり、最も強力な暗号スイートが優先的に設定されていることを検証します。 | ✓ | ✓ | ✓ | 326 |
| **9.1.3** | TLS 1.2 や TLS 1.3 など、最新の推奨バージョンの TLS プロトコルのみが有効であることを検証します。最新バージョンの TLS プロトコルが優先オプションであるべきです。 | ✓ | ✓ | ✓ | 326 |
| **9.1.4** | シッククライアントアプリケーションの場合、アプリが独自の証明書ストアを使用するか、エンドポイント証明書または公開鍵をピン留めするかしており、信頼できる CA により署名されていたとしても、異なる証明書や鍵を提供するエンドポイントとの接続を確立しないことを検証します。 |   |   | ✓ | 295 |

## V9.2 サーバー通信セキュリティ要件

サーバー通信は HTTP だけではありません。監視システム、管理ツール、リモートアクセスと ssh 、ミドルウェア、データベース、メインフレーム、パートナー、既存のソースシステムなど、他のシステムとのセキュアな接続を確立する必要があります。「外側は堅牢だが、内側は傍受しやすい」ことを防ぐために、これらはすべて暗号化する必要があります。

| # | 説明 | L1 | L2 | L3 | CWE |
| :---: | :--- | :---: | :---:| :---: | :---: |
| **9.2.1** | サーバーとの接続には信頼できる TLS 証明書が使用されていることを検証します。内部生成証明書や自己署名証明書が使用されている場合、サーバーは特定の内部 CA および特定の自己署名証明書のみを信頼するように構成する必要があります。それ以外はすべて拒否されるべきです。 |  | ✓ | ✓ | 295 |
| **9.2.2** | 管理ポート、監視、認証、API、ウェブサービス呼び出し、データベース、クラウド、サーバーレス、メインフレーム、外部、パートナー接続を含む、すべてのインバウンド接続およびアウトバウンド接続に、TLS などの暗号化通信が使用されていることを検証します。サーバーはセキュアではないプロトコルや暗号化されていないプロトコルにフォールバックしてはいけません。 |  | ✓ | ✓ | 319 |
| **9.2.3** | 機密情報や機密機能を含む外部システムへのすべての暗号化接続が認証されていることを検証します。 |  | ✓ | ✓ | 287 |
| **9.2.4** | オンライン証明書ステータスプロトコル (OSCP) ステープルなどの適切な証明書失効が有効かつ構成されていることを検証します。 |  | ✓ | ✓ | 299 |
| **9.2.5** | バックエンド TLS 接続失敗がログに記録されていることを検証します。 |  |  | ✓ | 544 |

## 参考情報

詳細については、以下も参照してください。

*  [OWASP – TLS Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html)
*  [OWASP - Pinning Guide](https://owasp.org/www-community/controls/Certificate_and_Public_Key_Pinning)
* 「TLS の承認されたモード」に関する注意。これまで ASVS は米国規格 FIPS 140-2 を参照していましたが、グローバル規格として US 規格の適用は困難、矛盾、混乱の可能性があります。9.1.3 に準拠するより良い方法は[Mozilla の Server Side TLS](https://wiki.mozilla.org/Security/Server_Side_TLS) や [既知の良い構成を生成する](https://mozilla.github.io/server-side-tls/ssl-config-generator/) などのガイドを見直し、望ましいセキュリティレベルを得るためにsslyze などの既知の TLS 評価ツール、さまざまな脆弱性スキャナ、信頼できる TLS オンライン評価サービスを使用することです。一般的に、期限切れの暗号やセキュアではない暗号の使用、Perfect Forward Secrecy の欠如、期限切れの SSL プロトコルやセキュアではない SSL プロトコル、脆弱な優先暗号などがこのセクションでの不適合となります。
